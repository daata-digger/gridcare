<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GridCARE Dashboard</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header><h1>GridCARE Dashboard</h1></header>

  <section class="card">
    <h2>Realtime Grid Summary</h2>
    <pre id="summary">Loadingâ€¦</pre>
  </section>

  <script>
    async function loadSummary() {
      const el = document.getElementById("summary");
      try {
        const res = await fetch("/api/summary");
        const text = await res.text();
        let data;
        try { data = JSON.parse(text); }
        catch (e) { throw new Error(`Upstream returned non-JSON: ${text.slice(0,200)}`); }

        if (!res.ok || data.status === "error") {
          throw new Error(data.message || data.detail || "API error");
        }
        el.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        el.textContent = `Failed to load summary: ${err}`;
      }
    }
    loadSummary();
  </script>
</body>
</html>
